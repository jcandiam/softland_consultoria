trigger:
- main

pool:
  vmImage: ubuntu-latest

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.11'
  displayName: Use Python 3.11

- script: |
    python -m pip install --upgrade pip
    pip install -r requirements.txt
  displayName: Install dependencies

- script: |
    python src/v2/run_v2.py
  displayName: Run V2 - Extract dataset from SQL
  env:
    DB_DRIVER: $(DB_DRIVER)
    DB_SERVER: $(DB_SERVER)
    DB_NAME: $(DB_NAME)
    DB_USER: $(DB_USER)
    DB_PASSWORD: $(DB_PASSWORD)

- script: |
    python src/v2/train_v2.py
  displayName: Train V2 model and log to MLflow
